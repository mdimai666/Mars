<g id="Layer_2" data-name="Layer 2" class="user-select-none @(node.selected?"red-ui-mic-node-selected":"")"
   transform="translate(@X.ToString(CultureInfo.InvariantCulture),@Y.ToString(CultureInfo.InvariantCulture)) scale(0.9)"
   node-id="@node.Id"
   @onclick:stopPropagation=true
   @ondblclick:stopPropagation=true>
    <g id="Layer_1-2" data-name="Layer 1">
        @*body*@
        <g class="red-ui-flow-node"
           @onmousedown=OnMouseDownMethod
           @onmousedown:stopPropagation=true
           @onmouseup=OnMouseUpMethod
           @onmouseup:stopPropagation=true
           @onclick=OnClickEvent
           @onclick:stopPropagation=true
           @ondblclick=OnDblClickEvent
           @ondblclick:stopPropagation=true>

            <polygon class="micr-cls-1" points="24.33 99 29.33 94 93.33 94 98.33 99 24.33 99" />
            <polygon class="micr-cls-2" points="24.33 0 29.33 5 29.33 94 24.33 99 24.33 0" />
            <polygon class="micr-cls-3" points="98.33 0 93.33 5 93.33 94 98.33 99 98.33 0" />
            <path class="micr-cls-4" d="M68.81,5a8.82,8.82,0,0,1-7.58,4,8.88,8.88,0,0,1-7.38-4H29.33V94h64V5Z" />
            <g>
                <path class="micr-cls-5" d="M52.33,0h-28l5,5H53.85A8.94,8.94,0,0,1,52.33,0Z" />
                <path class="micr-cls-5" d="M70.33,0a8.94,8.94,0,0,1-1.52,5H93.33l5-5Z" />
            </g>
            <path class="micr-cls-6" d="M70.33,0a9,9,0,0,1-9,9,9,9,0,0,1-9-9L48.26,5a14,14,0,0,0,13.07,9A14,14,0,0,0,74.4,5Z" />

            <g transform="translate(24.33,0)">
                <path class="micr-backplate" d="M46,0a9.87,9.87,0,0,1-.09,1.22c0,.09,0,.19,0,.29a7.64,7.64,0,0,1-.26,1.15h0a9.66,9.66,0,0,1-.43,1.1c0,.08-.07.16-.11.23a7.77,7.77,0,0,1-.58,1,.76.76,0,0,1-.08.11,8.91,8.91,0,0,1-3.79,3.13l-.15.07L40,8.47l-.75.23-.14,0a10.11,10.11,0,0,1-2.2.27H36.7c-.26,0-.51,0-.77-.06l-.47-.07-.57-.12-.43-.11c-.21-.06-.42-.14-.62-.21A9.88,9.88,0,0,1,32.79,8l-.08,0A9.06,9.06,0,0,1,29.59,5.1L29.52,5a7.77,7.77,0,0,1-.58-1c0-.07-.07-.15-.11-.23a9.66,9.66,0,0,1-.43-1.1h0a7.64,7.64,0,0,1-.26-1.15c0-.1,0-.2-.05-.29A9.87,9.87,0,0,1,28,0H0V99H74V0Z" fill="transparent" />
            </g>
        </g>
        <g>
            <g>
                <circle class="micr-cls-7" cx="38.33" cy="14" r="3.87" />
                <path class="micr-cls-8" d="M38.33,10.25A3.75,3.75,0,1,1,34.58,14a3.75,3.75,0,0,1,3.75-3.75m0-.25a4,4,0,1,0,4,4,4,4,0,0,0-4-4Z" />
            </g>
            <path class="micr-cls-2" d="M38.48,9.9a3.93,3.93,0,0,0-2.37.8,3.83,3.83,0,0,1,1.48-.29A4,4,0,0,1,40,17.66,4,4,0,0,0,38.48,9.9Z" />
            <path class="micr-cls-6" d="M38.33,18a3.94,3.94,0,0,0,2.36-.79,4,4,0,0,1-1.47.29,4,4,0,0,1-2.36-7.26A4,4,0,0,0,38.33,18Z" />

            <image href="_content/Mars.Nodes.Workspace/nodes/function.svg"
                   class="red-ui-flow-node-icon"
                   x="30"
                   width="30"
                   height="30"
                   style=""
                   y="25">
            </image>
        </g>

        <g>
            @for (int i = 0; i < 8; i++)
            {
                float x = 0;
                float y = 0;

                if (i < 4)
                {
                    x = 1;
                    y = i * 23f;
                }
                else
                {
                    y = (4 - i) * 23f + 68;
                    x = 74 + 48;
                }

                bool rotate = i >= 4;
                string rot_str = rotate ? "scale(-1, 1)" : "";
                string transl = $"translate({x.ToString(CultureInfo.InvariantCulture)},{y.ToString(CultureInfo.InvariantCulture)})";


                <g transform="@transl @rot_str" class="red-ui-flow-port">
                    <polyline class="micr-cls-9" points="24.33 8.01 7 8.01 7 21.99 24.33 21.99" />
                    <circle class="micr-cls-10" cx="7" cy="15" r="7" v-add-class-hover="red-ui-flow-port-hovered"
                        @onmousedown=OnInputWirePointDown
                        @onmousedown:stopPropagation=true
                        @onmouseup=OnInputWirePointUp
                        @onmouseup:stopPropagation=true />
                    <polyline class="micr-cls-11" points="24.33 7 18.37 7 18.37 23 24.33 23" />
                    <polygon class="micr-cls-12" points="17.33 21.99 18.37 23 18.37 7 17.33 8 17.33 21.99" />
                </g>
            }
            @*<g>
            <polyline class="micr-cls-9" points="24.33 31.15 7 31.15 7 45.13 24.33 45.13" />
            <circle class="micr-cls-10" cx="7" cy="38.14" r="7" />
            <polyline class="micr-cls-11" points="24.33 30.14 18.37 30.14 18.37 46.14 24.33 46.14" />
            <polygon class="micr-cls-12" points="17.33 45.13 18.37 46.14 18.37 30.14 17.33 31.14 17.33 45.13" />
            </g>
            <g>
            <polyline class="micr-cls-9" points="24.33 54.3 7 54.3 7 68.28 24.33 68.28" />
            <circle class="micr-cls-10" cx="7" cy="61.29" r="7" />
            <polyline class="micr-cls-11" points="24.33 53.29 18.37 53.29 18.37 69.29 24.33 69.29" />
            <polygon class="micr-cls-12" points="17.33 68.28 18.37 69.29 18.37 53.29 17.33 54.29 17.33 68.28" />
            </g>
            <g>
            <polyline class="micr-cls-9" points="24.33 77.44 7 77.44 7 91.42 24.33 91.42" />
            <circle class="micr-cls-10" cx="7" cy="84.43" r="7" />
            <polyline class="micr-cls-11" points="24.33 76.43 18.37 76.43 18.37 92.43 24.33 92.43" />
            <polygon class="micr-cls-12" points="17.33 91.42 18.37 92.43 18.37 76.43 17.33 77.43 17.33 91.42" />
            </g>*@

            @*<g>
            <polyline class="micr-cls-9" points="98.33 92.3 115.66 92.3 115.66 78.32 98.33 78.32" />
            <circle class="micr-cls-10" cx="115.66" cy="85.31" r="7" />
            <polyline class="micr-cls-11" points="98.33 93.31 104.29 93.31 104.29 77.31 98.33 77.31" />
            <polygon class="micr-cls-12" points="105.33 78.32 104.29 77.31 104.29 93.31 105.33 92.31 105.33 78.32" />
            </g>
            <g>
            <polyline class="micr-cls-9" points="98.33 69.16 115.66 69.16 115.66 55.17 98.33 55.17" />
            <circle class="micr-cls-10" cx="115.66" cy="62.16" r="7" />
            <polyline class="micr-cls-11" points="98.33 70.16 104.29 70.16 104.29 54.16 98.33 54.16" />
            <polygon class="micr-cls-12" points="105.33 55.17 104.29 54.16 104.29 70.16 105.33 69.16 105.33 55.17" />
            </g>
            <g>
            <polyline class="micr-cls-9" points="98.33 46.01 115.66 46.01 115.66 32.03 98.33 32.03" />
            <circle class="micr-cls-10" cx="115.66" cy="39.02" r="7" />
            <polyline class="micr-cls-11" points="98.33 47.02 104.29 47.02 104.29 31.02 98.33 31.02" />
            <polygon class="micr-cls-12" points="105.33 32.03 104.29 31.02 104.29 47.02 105.33 46.02 105.33 32.03" />
            </g>
            <g>
            <polyline class="micr-cls-9" points="98.33 22.87 115.66 22.87 115.66 8.89 98.33 8.89" />
            <circle class="micr-cls-10" cx="115.66" cy="15.88" r="7" />
            <polyline class="micr-cls-11" points="98.33 23.88 104.29 23.88 104.29 7.88 98.33 7.88" />
            <polygon class="micr-cls-12" points="105.33 8.89 104.29 7.88 104.29 23.88 105.33 22.88 105.33 8.89" />
            </g>*@
        </g>
        <g>
            @*<path class="micr-cls-13" d="M68.57,19.5H85.21v2.25H68.57Zm0,8.81H85.21v2.25H68.57ZM75.37,24l6.89-1.9v-.67h2.95V23l-7.14,1.9V25l-2.7.24Zm0,.68,2.7.35v.14L85.21,27v1.67H82.26V28l-6.89-1.9Z" />
            <path class="micr-cls-13" d="M68.57,33.94H85.21v2.34H68.57Zm0,0H70.8V45H68.57Zm7.22,0H78v8.9H75.79Zm7.2,0h2.22V45H83Z" />
            <path class="micr-cls-13" d="M68.34,54.35a7,7,0,0,1,2.14-5.59q2.14-1.86,6.44-1.86a9.33,9.33,0,0,1,6.3,1.93,6.83,6.83,0,0,1,2.23,5.43,7.85,7.85,0,0,1-.55,3.06,3.93,3.93,0,0,1-1.54,1.93L81.63,57.5a3.78,3.78,0,0,0,1.23-1.35,3.66,3.66,0,0,0,.43-1.75,4.44,4.44,0,0,0-1.63-3.68A7.19,7.19,0,0,0,77,49.41a7.68,7.68,0,0,0-4.9,1.31,4.71,4.71,0,0,0-1.64,3.91,8.23,8.23,0,0,0,.22,2c.15.56.27,1,.37,1.38l-2,.92c-.1-.33-.24-.91-.43-1.73A13.23,13.23,0,0,1,68.34,54.35Zm.7,2.32h7.85V58.9H69Zm5.63-3.4h2.22v5.56H74.67Z" />
            <path class="micr-cls-13" d="M68.57,60.71l16.64,4.81v3.4l-16.64,4.8V71.26L83.2,67.32v-.21L68.57,63.18Zm4.06,2.23h2.22v8.44H72.63Z" />
            *@
            <text class="red-ui-flow-node-label-text"
                  fill="#ecedef"
                  font-size="20px"
                  transform="translate(70 18) rotate(90)">
                @node.DisplayName
            </text>
        </g>
        @if (node.changed)
        {
            <g class="red-ui-flow-node-changed 1hide"
           transform="translate(90, -2)">
                <circle r="5"></circle>
            </g>
        }
    </g>
</g>

